# 内存分配（kmalloc/vmalloc/slab等）

## 面试高频问答总结

### 1. 常见的内核内存分配方式有哪些？
- kmalloc：分配连续物理内存，适合小块、频繁分配。
- vmalloc：分配虚拟连续但物理不连续内存，适合大块内存。
- slab分配器：高效管理小对象，减少碎片。

### 2. kmalloc和vmalloc的区别？
| 方式    | 物理内存连续 | 分配速度 | 适用场景 |
| ------- | ------------ | -------- | -------- |
| kmalloc | 是           | 快       | 小块、DMA |
| vmalloc | 否           | 慢       | 大块、非DMA |

### 3. slab分配器的原理？
- 预先分配内存池，按对象大小分组，重复利用，减少碎片。

#### slab分配流程图
```mermaid
flowchart LR
    A[请求分配对象] --> B[查找slab缓存]
    B -->|有空闲| C[返回对象]
    B -->|无空闲| D[分配新slab]
    D --> C
```

### 4. 内存碎片化是什么？如何避免？
- 内存被反复分配/释放后，出现很多小块空闲，难以利用。
- slab分配器、合适的分配策略可缓解。

### 5. 形象比喻
- kmalloc像“订一整排座位”，vmalloc像“拼凑空余座位”，slab像“专门为常用物品准备的小格子”。

---

[返回总目录](README.md)
