# 融合感知算法测试报告需求书

## 一、测试目的

本报告旨在评估融合感知算法在连续运动场景下的定位精度和稳定性，为运动控制开发提供可靠的感知数据支持。

## 二、测试环境与条件

- **测试环境**：实际运行环境或与实际环境高度相似的测试场地。
- **测试设备**：
  - 迦智相机（作为真值参考）
  - 编码器（增量式）
  - 融合感知算法模块（待测主感知+编码器融合）
- **测试条件**：
  - 测试过程为连续运动轨迹，而非单点静态测试。
  - 测试轨迹应覆盖实际运行工况，包括直线运动、加减速、启停、方向切换等典型场景。
  - 测试样本量：单次测试轨迹长度≥10m，连续测试次数≥10次，确保非偶发故障。

## 三、测试方法与步骤

1. **初始化**：
   - 设备初始化，确保相机、编码器、融合算法模块正常工作。
   - 记录初始位姿作为基准点（$P_0$）。

2. **连续运动测试**：
   - 控制设备沿预定轨迹连续运动，记录每一帧的融合感知输出位姿（$P_{fusion}(t)$）和相机感知真值位姿（$P_{camera}(t)$）。
   - 测试过程中，融合感知输出频率≥20Hz，相机真值采样频率≥50Hz。

3. **数据记录与同步**：
   - 记录融合感知算法输出的位姿数据（位置$x,y$，姿态$\theta$）。
   - 记录相机真值位姿数据（位置$x,y$，姿态$\theta$）。
   - 确保融合感知数据与相机真值数据时间戳同步，误差≤5ms。

## 四、误差计算方法

- 以初始点$P_0$为基准，计算每一帧相对位姿变化：
  
  $$
  \Delta P_{fusion}(t) = P_{fusion}(t) - P_{fusion}(0)
  $$

  $$
  \Delta P_{camera}(t) = P_{camera}(t) - P_{camera}(0)
  $$

- 每一帧的感知误差定义为融合感知相对位姿与相机真值相对位姿之差：

  $$
  e(t) = \Delta P_{fusion}(t) - \Delta P_{camera}(t)
  $$

- 误差指标包括：
  - 位置误差（$e_{pos}(t)$）：
  
    $$
    e_{pos}(t) = \sqrt{(x_{fusion}(t)-x_{camera}(t))^2 + (y_{fusion}(t)-y_{camera}(t))^2}
    $$

  - 姿态误差（$e_{\theta}(t)$）：
  
    $$
    e_{\theta}(t) = |\theta_{fusion}(t)-\theta_{camera}(t)|
    $$

- 统计误差指标：
  - 平均误差（Mean Error）：
  
    $$
    \bar{e} = \frac{1}{N}\sum_{t=1}^{N} e(t)
    $$

  - 均方根误差（RMSE）：
  
    $$
    RMSE = \sqrt{\frac{1}{N}\sum_{t=1}^{N} e(t)^2}
    $$

  - 最大误差（Max Error）：
  
    $$
    e_{max} = \max_{t\in[1,N]} e(t)
    $$

## 五、测试结果要求

- 提供完整的测试数据记录，包括：
  - 融合感知输出数据（时间戳、位置、姿态）
  - 相机真值数据（时间戳、位置、姿态）
- 提供误差统计分析结果，包括：
  - 位置误差和姿态误差的平均值、RMSE、最大值
  - 误差随时间变化的曲线图
- 提供异常情况分析：
  - 误差超过允许范围（位置误差>3mm，姿态误差>0.05°）的情况统计和分析
  - 异常情况发生时的环境条件和可能原因分析

## 六、不同感知方式误差要求

根据不同感知方式的技术特点和实际应用场景，定义不同感知方式的定位误差允许范围如下：

| 感知方式 | 位置误差（RMSE） | 姿态误差（RMSE） |
| --- | --- | --- |
| 飞箱感知 | ≤1cm | ≤1° |
| Marker感知 | ≤2cm | ≤2° |
| 脚腕感知 | ≤2cm | ≤2° |

说明：  
- 测试时需根据实际使用的感知方式，分别验证对应的误差指标。
- 若同时使用多种感知方式融合定位，则以精度要求最高的感知方式为准。

## 七、报告交付物

- 测试报告文档（Markdown或PDF格式）
- 测试数据原始记录（CSV或Excel格式）
- 异常情况分析报告（如有异常情况发生）

## 八、其他要求

- 测试过程需录像存档，便于后续问题追溯。
- 测试环境和设备配置需详细记录，确保测试可复现。
- 测试报告需经感知组负责人审核签字后提交给运动控制开发人员。